
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Spec API vs. Python API &#8212; ploomber 0.19.6 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/mermaid-style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/mermaid-layout.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/js/custom.js"></script>
    <script src="../_static/js/mermaid.min.js"></script>
    <script src="../_static/js/terminal.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Cloud" href="../cloud/index.html" />
    <link rel="prev" title="FAQ and Glossary" href="faq_index.html" />
 

<!-- Required meta tags -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<!-- Bootstrap CSS -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

<style>
    body {
        padding-top: 5rem;
    }

    /* make all images responsive (same as .img-fluid) */
    img {
        max-width: 100%;
        height: auto;
    }
</style>

<!-- Algolia -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" />
</pre>
</link>

<!-- Below script for subscribe button in videos page-->
<script src="https://apis.google.com/js/platform.js"></script>
<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<!-- jQuery is loaded by sphinx anyway -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
    crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
    crossorigin="anonymous"></script>




  </head><body>



<nav class="navbar navbar-expand-md navbar-dark fixed-top">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#first-column"
        aria-controls="first-column" aria-expanded="false" aria-label="Toggle TOC">
        <span class="navbar-toggler-icon"></span>
    </button>

    <a class="navbar-brand" href="../index.html">Ploomber</a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#top-bar" aria-controls="top-bar"
        aria-expanded="false" aria-label="Toggle navigation">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-search"
            viewBox="0 0 16 16">
            <path
                d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
        </svg>
    </button>

    <div class="collapse navbar-collapse" id="top-bar">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item  active ">
                <a class="nav-link" href="../index.html">Documentation
                </a>
            </li>
            <li class="nav-item ">
                <a class="nav-link" href="../cloud/cloud-execution.html">Cloud
                </a>
            </li>
            <li class="nav-item ">
                <a class="nav-link" href="../videos.html">Videos</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="https://github.com/ploomber/ploomber">GitHub</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="https://ploomber.io/community">Community</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="https://www.getrevue.co/profile/ploomber">Newsletter</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="https://ploomber.io">Blog</a>
            </li>
        </ul>

        <!-- By default any child element that uses Bootstrap nav class falls under display flex! -->
        <div class="flex-md-shrink-0" id="search">
            <!-- flex-md-shrink-0 is a responsive class inside boostrap flex class that shrinks elements as the width decreases!-->
            <form class="search form-inline my-2 my-lg-0" action="../search.html" method="get">
                <input class="form-control mr-sm-2" type="text" placeholder="Search" aria-label="Search" name="q">
                <button class="btn btn-secondary my-2 my-sm-0" type="submit">Search</button>
            </form>
        </div>

    </div>
</nav>



<div class="container-fluid">
    <div class="row">
        <div class="col-md-3 col-xl-2 first-column collapse" id="first-column">
            

<div class="global-toc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../get-started/index.html">Get Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use-cases/index.html">Use Cases</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="templates.html">Downloading templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html">Command-line interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="jupyter.html">Jupyter integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="scaffold.html">Scaffolding projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="refactoring.html">Refactoring legacy notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="parametrized.html">Parametrized pipelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">Configuration (<code class="docutils literal notranslate"><span class="pre">dev</span></code>/<code class="docutils literal notranslate"><span class="pre">prod</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-started/sql-pipeline.html">SQL Pipelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql-templating.html">SQL templating</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">Pipeline testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html">Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="versioning.html">Versioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="serialization.html">Serialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="shell.html">Shell tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="editors.html">Other editors (VSCode, PyCharm, etc.)</a></li>
<li class="toctree-l2"><a class="reference internal" href="r-support.html">R support</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq_index.html">FAQ and Glossary</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Spec API vs. Python API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cloud/index.html">Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment/index.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cookbook/index.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community/index.html">Community</a></li>
</ul>
</div>

            <div class="help-tooltip">
                <p>Something not working? <a
                        href="https://github.com/ploomber/ploomber/issues/new?body=Documentation+page%3A+user-guide%2Fspec-vs-python"
                        target="_blank" rel="noreferrer">Open an issue on
                        GitHub</a> or <a href="https://ploomber.io/community" target="_blank" rel="noreferrer">message
                        us on Slack.</a></p>
            </div>
        </div>
        <div class="col-md-9 col-xl-8">
            <div class="document">
                <div class="documentwrapper">
                    <div class="bodywrapper">
                        <div class="body" role="main">
                            
  <section id="spec-api-vs-python-api">
<h1>Spec API vs. Python API<a class="headerlink" href="#spec-api-vs-python-api" title="Permalink to this headline">¶</a></h1>
<p>There are two ways of writing pipelines with Ploomber. This document discusses
the differences and how to decide which API to use.</p>
<p>Data projects span a wide range of applications, from small projects requiring
a few scripts to large ones requiring greater flexibility.</p>
<p>If you’re getting started, the <span class="xref std std-ref">Spec API</span> is
recommended. The Spec API is flexible enough to handle many common use cases
without requiring you to learn a Python API, you can get started quickly and get
pretty far using some of the advanced feature, check out the full
<a class="reference internal" href="../api/spec.html"><span class="doc">documentation</span></a> for details.</p>
<p>However, the Spec API is static, meaning that your <code class="docutils literal notranslate"><span class="pre">pipeline.yaml</span></code>
completely describes your pipeline’s structure. Under some circumstances, you
may want your pipeline to be more “dynamic.” For example, you may use some
input parameters and create a “pipeline factory,” which is a function that
takes those input parameters and creates a pipeline, allowing you to morph
the specifics of your pipeline (number of tasks, dependencies among them, etc.)
dynamically, you can only achieve so via
the <span class="xref std std-ref">Python API is a</span>. The downside is that it has
a steeper learning curve.</p>
<p>There is a third way of assembling a pipeline by pointing to a <a class="reference internal" href="#directory-entry-point"><span class="std std-ref">directory</span></a> with
scripts. This API allows you quickly test simple pipelines that may only have
a couple of tasks.</p>
<p>For examples using different APIs, <a class="reference external" href="https://github.com/ploomber/projects">click here</a></p>
<p>Depending on the API you use, the pipeline will be exposed to Ploomber
differently. For example, if using the Spec API, you tell the pipeline to
Ploomber by pointing to the path to a <code class="docutils literal notranslate"><span class="pre">pipeline.yaml</span></code> file, known
as an entry point, discussed below.</p>
<section id="entry-points">
<h2>Entry points<a class="headerlink" href="#entry-points" title="Permalink to this headline">¶</a></h2>
<p>To execute your pipeline, Ploomber needs to know where it is. This location is
known as “entry point”. There are three types of entry points (ordered by
flexibility):</p>
<ol class="arabic simple">
<li><p>A directory</p></li>
<li><p>[Spec API] Spec (aka <code class="docutils literal notranslate"><span class="pre">pipeline.yaml</span></code>)</p></li>
<li><p>[Python API] Factory function (a function that returns a <code class="docutils literal notranslate"><span class="pre">DAG</span></code> object)</p></li>
</ol>
<p>The following sections describe each entry point in detail.</p>
</section>
<section id="directory-entry-point">
<h2>Directory entry point<a class="headerlink" href="#directory-entry-point" title="Permalink to this headline">¶</a></h2>
<p>Ploomber can figure out your pipeline without even having a <code class="docutils literal notranslate"><span class="pre">pipeline.yaml</span></code>,
by just passing a directory. This kind of entry point is the simplest one but
also, the less flexible, since there isn’t a pipeline definition, <strong>products
must be declared in the source code itself</strong>. Note that only Python and R
scripts support this, for example:</p>
<div class="text-editor highlight-python notranslate" id="task-py"><div class="highlight"><pre><span></span><span class="c1"># %% tags=[&quot;parameters&quot;]</span>
<span class="n">product</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;nb&#39;</span><span class="p">:</span> <span class="s1">&#39;output.ipynb&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;output.csv&#39;</span><span class="p">}</span>
<span class="n">upstream</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a_task&#39;</span><span class="p">]</span>
<span class="c1">#</span>

<span class="c1"># continues...</span>
</pre></div>
</div>
<p>Internally, Ploomber uses the <a class="reference internal" href="../api/_modules/spec/ploomber.spec.DAGSpec.html#ploomber.spec.DAGSpec.from_directory" title="ploomber.spec.DAGSpec.from_directory"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ploomber.spec.DAGSpec.from_directory</span></code></a>
method. See the documentation for details.</p>
<p>All commands that accept the <code class="docutils literal notranslate"><span class="pre">--entry-point/-e</span></code> parameter can take a
directory as a value. For example, to build a pipeline using the current
directory:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ploomber build --entry-point .</span>
</pre></div>
</div>
<p>It’s also possible to select a subset of the files in a directory using a
glob-like pattern:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ploomber build --entry-point &quot;*.py&quot; # note the quotes</span>
</pre></div>
</div>
<p><strong>Note:</strong> Pipelines built without a <code class="docutils literal notranslate"><span class="pre">pipeline.yaml</span></code> file cannot be parametrized.</p>
</section>
<section id="spec-api-spec-entry-point">
<h2>[Spec API] Spec entry point<a class="headerlink" href="#spec-api-spec-entry-point" title="Permalink to this headline">¶</a></h2>
<p>If you want to customize how Ploomber executes your pipeline,
you have to create a <code class="docutils literal notranslate"><span class="pre">pipeline.yaml</span></code> file; this is known as a
<strong>spec entry point</strong>. A <code class="docutils literal notranslate"><span class="pre">pipeline.yaml</span></code> file is the recommended approach for
most projects: it has a good level of flexibility and doesn’t require you to
learn Ploomber’s internal Python API.</p>
<p>To call a DAG defined in a <code class="docutils literal notranslate"><span class="pre">path/to/pipeline.yaml</span></code> file pass the path:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ploomber build --entry-point pah/to/pipeline.yaml</span>
</pre></div>
</div>
<p>If your pipeline exists inside a package:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ploomber build --entry-point my_package::pah/to/pipeline.yaml</span>
</pre></div>
</div>
<p>The command above searches for package <code class="docutils literal notranslate"><span class="pre">my_package</span></code> (by doing <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">my_package</span></code>), then uses the relative path.</p>
<p>You can omit the <code class="docutils literal notranslate"><span class="pre">--entry-point</span></code> argument if the <code class="docutils literal notranslate"><span class="pre">pipeline.yaml</span></code> is in a standard location (<a class="reference internal" href="../api/cli.html#api-cli-default-locations"><span class="std std-ref">Default locations</span></a>).</p>
<p>An added feature is pipeline parametrization, to learn more <a class="reference internal" href="parametrized.html"><span class="doc">Parametrized pipelines</span></a>.</p>
<p>For schema details see: <a class="reference internal" href="../api/spec.html"><span class="doc">Spec API (pipeline.yaml)</span></a>.</p>
</section>
<section id="python-api-factory-entry-point">
<h2>[Python API] Factory entry point<a class="headerlink" href="#python-api-factory-entry-point" title="Permalink to this headline">¶</a></h2>
<p>The last approach requires you to write Python code to specify your pipeline.
It has a steeper learning curve because you have to become familiar with the
API specifics, but it provides the most significant level of flexibility.</p>
<p>The primary advantage is dynamic pipelines, whose exact number of tasks
and dependency relations are determined when executing your Python code.
For example, you might use a for loop to dynamically generate a few tasks
based on some input parameters.</p>
<p>For Ploomber to know how to build your pipeline written as Python code, you have
to provide a <strong>factory entry point</strong>, which is a function that returns a
<code class="docutils literal notranslate"><span class="pre">DAG</span></code> object. For example, if your factory is a function called <cite>make</cite> in
a file called <code class="docutils literal notranslate"><span class="pre">pipeline.py</span></code>, then your entry point is the dotted path
<code class="docutils literal notranslate"><span class="pre">pipeline.make</span></code>, which may look like this:</p>
<div class="text-editor highlight-python notranslate" id="factory-py"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ploomber</span> <span class="kn">import</span> <span class="n">DAG</span>

<span class="k">def</span> <span class="nf">make</span><span class="p">():</span>
    <span class="n">dag</span> <span class="o">=</span> <span class="n">DAG</span><span class="p">()</span>
    <span class="c1"># add tasks to your pipeline...</span>
    <span class="k">return</span> <span class="n">dag</span>
</pre></div>
</div>
<p>You can execute commands against your pipeline like this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ploomber {command} --entry-point pipeline.make</span>
</pre></div>
</div>
<p>Internally, Ploomber will do something like this:</p>
<div class="text-editor highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pipeline</span> <span class="kn">import</span> <span class="n">make</span>

<span class="n">dag</span> <span class="o">=</span> <span class="n">make</span><span class="p">()</span>

<span class="c1"># (if using ploomber build)</span>
<span class="n">dag</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
</pre></div>
</div>
<p>If your factory function has arguments, they will show up in the CLI. This
guide shows how to parametrize a factory
function: <a class="reference internal" href="parametrized.html"><span class="doc">Parametrized pipelines</span></a></p>
<p>If your factory function has a docstring, the first line displays
in the CLI help menu (e.g. <code class="docutils literal notranslate"><span class="pre">ploomber</span> <span class="pre">build</span> <span class="pre">--entry-point</span> <span class="pre">factory.make</span> <span class="pre">--help</span></code>). If
the docstring is in
the <a class="reference external" href="https://numpydoc.readthedocs.io/en/latest/format.html#docstring-standard">numpydoc format</a>
(and numpydoc is installed, <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">numpydoc</span></code>), descriptions for
documented parameters will be displayed as well.</p>
</section>
</section>


                            <div class="clearer"></div>
                        </div>
                    </div>
                </div>
                <div class="clearer"></div>
            </div>
        </div>
        <div class="d-none d-xl-block col-xl-2 third-column">
            
<div class="sphinxsidebar" role="navigation" aria-label="main navigation">
    <div class="sphinxsidebarwrapper">
<ul>
<li><a class="reference internal" href="#">Spec API vs. Python API</a><ul>
<li><a class="reference internal" href="#entry-points">Entry points</a></li>
<li><a class="reference internal" href="#directory-entry-point">Directory entry point</a></li>
<li><a class="reference internal" href="#spec-api-spec-entry-point">[Spec API] Spec entry point</a></li>
<li><a class="reference internal" href="#python-api-factory-entry-point">[Python API] Factory entry point</a></li>
</ul>
</li>
</ul>

    </div>
</div>
        </div>
    </div>
</div>


<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>

<script type="text/javascript">
    docsearch({
        appId: 'Y6L7HQ2HZO',
        apiKey: 'a44b754f3d890a27dcbd9b4f860fea6b',
        indexName: 'ploomber',
        container: '#search',
        debug: false

    });
</script>
<div class="footer" role="contentinfo">
</div>
  </body>
</html>